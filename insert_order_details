create or replace procedure insert_order_details as  

header number;
begin
for c_rec in (SELECT
    "A1"."ORDER_REF"           "ORDER_REF",
    "A1"."ORDER_DATE"          "ORDER_DATE",
    "A1"."SUPPLIER_NAME"       "SUPPLIER_NAME",
    "A1"."SUPP_CONTACT_NAME"   "SUPP_CONTACT_NAME",
    "A1"."SUPP_ADDRESS"        "SUPP_ADDRESS",
    "A1"."SUPP_CONTACT_NUMBER" "SUPP_CONTACT_NUMBER",
    "A1"."SUPP_EMAIL"          "SUPP_EMAIL",
    "A1"."ORDER_TOTAL_AMOUNT"  "ORDER_TOTAL_AMOUNT",
    "A1"."ORDER_DESCRIPTION"   "ORDER_DESCRIPTION",
    "A1"."ORDER_STATUS"        "ORDER_STATUS",
    "A1"."ORDER_LINE_AMOUNT"   "ORDER_LINE_AMOUNT",
    "A1"."INVOICE_REFERENCE"   "INVOICE_REFERENCE",
    "A1"."INVOICE_DATE"        "INVOICE_DATE",
    "A1"."INVOICE_STATUS"      "INVOICE_STATUS",
    "A1"."INVOICE_HOLD_REASON" "INVOICE_HOLD_REASON",
    "A1"."INVOICE_AMOUNT"      "INVOICE_AMOUNT",
    "A1"."INVOICE_DESCRIPTION" "INVOICE_DESCRIPTION"
FROM
    "APPS"."XXBCM_ORDER_MGT" "A1"
WHERE
    "A1"."ORDER_REF" NOT LIKE '%-%')
loop
     INSERT INTO XXBCM_ORDER_HEADERS_MGT
             (ORDER_HEADER_ID
		 ,PO_NUMBER
             ,ORDER_DATE
             ,SUPPLIER_NAME
             ,ORDER_TOTAL_AMOUNT
             ,ORDER_DESCRIPTION
             ,ORDER_STATUS
             )
     VALUES
             (XXBCM_ORDER_HEADERS_MGT_S.nextval,	
			 c_rec.ORDER_REF,
			 c_rec.ORDER_DATE,
			 c_rec.SUPPLIER_NAME,
			 c_rec.ORDER_TOTAL_AMOUNT,
			 c_rec.ORDER_DESCRIPTION,
			 c_rec.ORDER_STATUS
             );
end loop;
commit;
	for c_sec in (SELECT
    "A1"."ORDER_REF"           "ORDER_REF",
    "A1"."ORDER_DATE"          "ORDER_DATE",
    "A1"."SUPPLIER_NAME"       "SUPPLIER_NAME",
    "A1"."SUPP_CONTACT_NAME"   "SUPP_CONTACT_NAME",
    "A1"."SUPP_ADDRESS"        "SUPP_ADDRESS",
    "A1"."SUPP_CONTACT_NUMBER" "SUPP_CONTACT_NUMBER",
    "A1"."SUPP_EMAIL"          "SUPP_EMAIL",
    "A1"."ORDER_TOTAL_AMOUNT"  "ORDER_TOTAL_AMOUNT",
    "A1"."ORDER_DESCRIPTION"   "ORDER_DESCRIPTION",
    "A1"."ORDER_STATUS"        "ORDER_STATUS",
    "A1"."ORDER_LINE_AMOUNT"   "ORDER_LINE_AMOUNT",
    "A1"."INVOICE_REFERENCE"   "INVOICE_REFERENCE",
    "A1"."INVOICE_DATE"        "INVOICE_DATE",
    "A1"."INVOICE_STATUS"      "INVOICE_STATUS",
    "A1"."INVOICE_HOLD_REASON" "INVOICE_HOLD_REASON",
    "A1"."INVOICE_AMOUNT"      "INVOICE_AMOUNT",
    "A1"."INVOICE_DESCRIPTION" "INVOICE_DESCRIPTION"
FROM
    "APPS"."XXBCM_ORDER_MGT" "A1"
WHERE
    "A1"."ORDER_REF" LIKE '%-%')
             loop
			 select ORDER_HEADER_ID into header from XXBCM_ORDER_HEADERS_MGT where po_number = substr(c_sec.ORDER_REF, 1, instr(c_sec.ORDER_REF, '-') -1);
			 Insert into XXBCM_ORDER_lINES_MGT
				(ORDER_HEADER_ID,
				PO_NUMBER,
				ORDER_DATE,
				SUPPLIER_NAME,
				INVOICE_NUMBER,
				ORDER_LINE_AMOUNT ,
				ORDER_DESCRIPTION ,
				ORDER_STATUS)
			VALUES ( header,
			c_sec.ORDER_REF,
			c_sec.ORDER_DATE,
			c_sec.SUPPLIER_NAME,
			c_sec.INVOICE_REFERENCE,
			c_sec.ORDER_LINE_AMOUNT,
			c_sec.ORDER_DESCRIPTION ,
			c_sec.ORDER_STATUS);
	end loop;
	commit;
	EXCEPTION
	when others THEN
	rollback;
end;
